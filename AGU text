# â”€â”€ replace the old auth_url assignment with THIS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
auth_url="https://x-access-token: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@github.com/LieutenantJimmy/M122-Klasse-M122-Giovanni-Agustin.git"


git remote set-url origin \
  "https://x-access-token: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@github.com/LieutenantJimmy/M122-Klasse-M122-Giovanni-Agustin.git"

# verify
git remote -v


export PAT=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
curl -u "x-access-token:$PAT" \
     https://api.github.com/repos/LieutenantJimmy/M122-Klasse-M122-Giovanni-Agustin


setup_github_repo() {
    # ----- add safe-token check here -----
    if [ -z "$GITHUB_TOKEN" ] || [ "${#GITHUB_TOKEN}" -lt 40 ]; then
        log_warn "GitHub token not set or invalid â€“ skipping Git sync"
        return 0
    fi
    # remainder of the functionâ€¦


EMAIL_ENABLED="true"                            # <â€“ already exists, make sure it's true
EMAIL_RECIPIENTS="agustin@example.com,giovanni@example.com"
EMAIL_SEND_ALWAYS="true"                        # <â€“ NEW: send mail always, not just on warning



# ==============================================================================
# EMAIL REPORT FUNCTION
# ==============================================================================

send_email_report() {
    if [[ "$EMAIL_ENABLED" != "true" ]]; then
        log_debug "E-mail disabled in config"
        return 0
    fi

    if ! command -v mail >/dev/null 2>&1; then
        log_warn "No 'mail' command installed â€“ canâ€™t send report"
        return 0
    fi

    local recipients
    recipients=$(echo "$EMAIL_RECIPIENTS" | tr ',' ' ')

    local subject="ğŸŒ¤ï¸ Daily Weather Report"
    local body="Weather report generated $(date '+%Y-%m-%d %H:%M:%S')

Location   : $DEFAULT_CITY, $DEFAULT_COUNTRY
Temperature: ${temperature:-N/A}Â°C
Humidity   : ${humidity:-N/A}%
Wind       : ${wind_speed:-N/A} km/h

-- This message was sent automatically by the Weather-Monitor script."

    log_info "Sending e-mail report to $EMAIL_RECIPIENTS"
    if echo "$body" | mail -s "$subject" $recipients; then
        log_info "E-mail sent successfully"
    else
        log_warn "E-mail failed"
    fi
}


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
